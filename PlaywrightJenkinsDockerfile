FROM jenkins/jenkins:lts

USER root

# Install system dependencies for Playwright browsers
RUN apt-get update && \
    apt-get install -y \
        curl \
        wget \
        gnupg \
        ca-certificates \
        # Chromium dependencies
        libnss3 \
        libatk-bridge2.0-0 \
        libdrm2 \
        libxkbcommon0 \
        libgbm1 \
        libasound2 \
        libxshmfence1 \
        libxrandr2 \
        libgtk-3-0 \
        libx11-xcb1 \
        libxcb-dri3-0 \
        # Firefox dependencies
        libdbus-glib-1-2 \
        libxt6 && \
    # Install Node.js 18
    curl -fsSL https://deb.nodesource.com/setup_18.x | bash - && \
    apt-get install -y nodejs && \
    # Verify
    node -v && npm -v

USER jenkins
